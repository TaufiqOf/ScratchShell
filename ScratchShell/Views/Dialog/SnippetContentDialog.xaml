<ui:ContentDialog
    x:Class="ScratchShell.View.Dialog.SnippetContentDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:ScratchShell.View.Dialog"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    Title="Snippet"
    d:DesignHeight="600"
    d:DesignWidth="500"
    ui:Design.Background="{DynamicResource ApplicationBackgroundBrush}"
    ui:Design.Foreground="{DynamicResource TextFillColorPrimaryBrush}"
    CloseButtonText="Close"
    PrimaryButtonText="Save"
    mc:Ignorable="d">

    <ui:ContentDialog.Resources>
        <Style BasedOn="{StaticResource {x:Type ui:ContentDialog}}" TargetType="{x:Type local:SnippetContentDialog}" />

        <!--  Add the BooleanToVisibilityConverter  -->
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter" />

        <!--  Style for validation error display  -->
        <Style x:Key="ValidationErrorTextBlock" TargetType="TextBlock">
            <Setter Property="Foreground" Value="Red" />
            <Setter Property="FontSize" Value="11" />
            <Setter Property="Margin" Value="0,2,0,5" />
            <Setter Property="TextWrapping" Value="Wrap" />
        </Style>

        <!--  Style for required field labels  -->
        <Style x:Key="RequiredFieldLabel" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Margin" Value="0,10,0,0" />
        </Style>
    </ui:ContentDialog.Resources>

    <Grid Width="450">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" VerticalAlignment="Top">
            <TextBlock Style="{StaticResource RequiredFieldLabel}">
                <Run Text="Snippet Name" />
                <Run Foreground="Red" Text="*" />
            </TextBlock>
            <ui:TextBox
                x:Name="NameTextBox"
                PlaceholderText="Enter snippet name"
                Text="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, NotifyOnValidationError=True}" />
            <TextBlock
                x:Name="NameErrorText"
                Style="{StaticResource ValidationErrorTextBlock}"
                Text="{Binding (Validation.Errors)[0].ErrorContent, ElementName=NameTextBox}"
                Visibility="{Binding (Validation.HasError), ElementName=NameTextBox, Converter={StaticResource BoolToVisibilityConverter}}" />

            <TextBlock Style="{StaticResource RequiredFieldLabel}">
                <Run Text="Code" />
                <Run Foreground="Red" Text="*" />
            </TextBlock>
        </StackPanel>

        <ui:TextBox
            x:Name="CodeTextBox"
            Grid.Row="1"
            Margin="0,5,0,0"
            AcceptsReturn="True"
            AcceptsTab="True"
            FontFamily="Consolas"
            HorizontalScrollBarVisibility="Auto"
            PlaceholderText="Enter your code snippet here..."
            Text="{Binding Code, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, NotifyOnValidationError=True}"
            TextWrapping="Wrap"
            VerticalScrollBarVisibility="Auto" />

        <!--  Validation summary  -->
        <Border
            x:Name="ValidationSummary"
            Grid.Row="1"
            Margin="0,10,0,0"
            Padding="10"
            VerticalAlignment="Bottom"
            Background="#FFFFE6E6"
            BorderBrush="Red"
            BorderThickness="1"
            CornerRadius="3"
            Visibility="Collapsed">
            <StackPanel>
                <TextBlock
                    FontWeight="Bold"
                    Foreground="Red"
                    Text="Please fix the following errors:" />
                <TextBlock
                    x:Name="ValidationSummaryText"
                    Foreground="Red"
                    TextWrapping="Wrap" />
            </StackPanel>
        </Border>
    </Grid>
</ui:ContentDialog>